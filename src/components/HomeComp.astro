---
import Image from 'astro/components/Image.astro';

interface Props {
    Title: string;
    num: string;
    year: string;
    Category: string;
    link: string;
    images?: ImageMetadata[]; 
}


const { Title, num, year, Category, link, images = [] } = Astro.props;
---

<div x-data="{ openGallery: false }" class="group no-scrollbar">
    <div class="grid grid-cols-2 sm:grid-cols-12 info leading-tight max-sm:py-2">
        <p class="col-span-1 ">[{num}]</p>
        <div class="col-span-1 sm:col-span-8">

            <a href={link} class="it uppercase link" @click.prevent="openGallery = !openGallery">
                {Title}
            </a>
        </div>
        <div class="col-span-1 sm:hidden"></div>
        <p class="col-span-1 sm:col-span-2">{Category}</p>
        <div class="col-span-1 sm:hidden"></div>
        <p class="col-span-1 sm:justify-self-end">{year}</p>
    </div>

    <div x-show="openGallery" x-cloak 
        x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        x-transition:leave="transition ease-in duration-200"
        x-transition:leave-start="opacity-100"
        x-transition:leave-end="opacity-0"
        class="flex overflow-x-auto gap-2 no-scrollbar">
        
        {images?.map((img, index) => (
            <Image 
                src={img} 
                alt={`Image ${index + 1}`} 
                width={500} 
                height={500} 
                format='webp'
                class="sm:hidden aspect-video object-cover w-[calc(75%-8px)]" 
            />
            <Image 
                src={img} 
                alt={`Image ${index + 1}`} 
                width={1080} 
                height={1080} 
                format='webp'
                class="max-sm:hidden lg:hidden aspect-video object-cover w-[calc(75%-8px)]" 
            />
            <Image 
                src={img} 
                alt={`Image ${index + 1}`} 
                width={1920} 
                height={1920} 
                format='webp'
                class="max-lg:hidden aspect-video object-cover w-[calc(75%-8px)]" 
            />
        ))}
        
        <div class="w-1/2 sm:w-[calc(100%*(11/12))] flex-shrink-0 whitespace-nowrap">
            <p>Ciao Ciao Ciao</p>
        </div>      
    </div>
</div>


<script is:inline>
    document.addEventListener('DOMContentLoaded', function() {
        const components = document.querySelectorAll('.group');

        components.forEach(component => {
            const linkElement = component.querySelector('.link');
            const infoElement = component.querySelector('.info');
            const imgElement = component.querySelector('.img');

            linkElement.addEventListener('mouseenter', () => {
                infoElement.classList.add('opacity-40');
                imgElement?.classList.remove('hidden');
                imgElement?.classList.add('block');
            });

            linkElement.addEventListener('mouseleave', () => {
                infoElement.classList.remove('opacity-40');
                imgElement?.classList.remove('block');
                imgElement?.classList.add('hidden');
            });
        });
    });
</script>
